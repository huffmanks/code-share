---
title: Miscellaneous
description: A collection of system configurations, tweaks and quick fixes for Linux environments.
tableOfContents:
  maxHeadingLevel: 5
---

import { Code, Steps } from "@astrojs/starlight/components";

export const logindConf = `
HandleSuspendKey=ignore
HandleLidSwitch=ignore
HandleLidSwitchDocked=ignore
`;

export const noSleepConfig = `
[Sleep]
AllowSuspend=no
AllowHibernation=no
AllowSuspendThenHibernate=no
AllowHybridSleep=no
`;

export const wifiPowerSaveConfig = `
[connection]
wifi.powersave = 2
`;

export const netplanConfig = `
network:
  version: 2
  ethernets:
    enp3s0:
      dhcp4: true
      optional: true
`

export const wolService = `
[Unit]
Description=Enable Wake On Lan

[Service]
Type=oneshot
ExecStart=/usr/sbin/ethtool -s $INTERFACE_NAME wol g

[Install]
WantedBy=basic.target
`;

<p>{frontmatter.description}</p>

---

## Laptop optimization

This ensures your laptop stays awake with the lid closed, maintains a stable network connection and boots quickly by ignoring unused network interfaces.

<Steps>

1. ### Lid and sleep configuration

   These steps prevent the system from suspending or shutting down when the lid is closed or the power button is pressed.

   <Steps>

   1. #### Open logind config

      <Code lang="sh" code={`sudo nano /etc/systemd/logind.conf`} />

   2. #### Update config

      Update the following lines to `ignore` to keep the system awake.

      <Code lang="sh" title="/etc/systemd/logind.conf" code={logindConf} />

   3. #### Restart logind

      <Code lang="sh" code={`sudo systemctl restart systemd-logind`} />

   </Steps>

2. ### Disable system-wide sleep

   To prevent the kernel from attempting to sleep even if triggered by software, create a “no-sleep” override.

   <Steps>

   1. #### Create nosuspend config

      <Code lang="sh" code={`sudo mkdir -p /etc/systemd/sleep.conf.d/ && sudo nano /etc/systemd/sleep.conf.d/nosuspend.conf`} />

   2. #### Add config

      <Code lang="sh" title="/etc/systemd/sleep.conf.d/nosuspend.conf" code={noSleepConfig} />

   3. #### Reload daemon

      <Code lang="sh" code={`sudo systemctl daemon-reload`} />

   </Steps>

3. ### Network stability & driver fixes

   Force NetworkManager to keep the Wi-Fi card at full power and stabilize Broadcom wireless drivers.

   <Steps>

   1. #### Check power management on network interfaces

      <Code lang="sh" code={`iwconfig`} />

   2. #### Open NetworkManager config

      <Code lang="sh" code={`sudo nano /etc/NetworkManager/conf.d/default-wifi-powersave-on.conf`} />

   3. #### Disable Wi-Fi power management

      Change the value from `3` (on) to `2` (off).

      <Code lang="sh" title="/etc/NetworkManager/conf.d/default-wifi-powersave-on.conf" code={wifiPowerSaveConfig} />

   4. #### Restart NetworkManager

      <Code lang="sh" code={`sudo systemctl restart NetworkManager`} />

   5. #### Create Broadcom drivers config

      <Code lang="sh" code={`sudo nano /etc/modprobe.d/broadcom-sta.conf`} />

   6. #### Add config

      This prevents antenna-switching bugs.

      <Code lang="text" code={`options wl one_ant_disable=1`} />

   7. #### Reinstall the driver

      <Code lang="sh" code={`sudo apt update && sudo apt install --reinstall bcmwl-kernel-source`} />

   </Steps>

4. ### Boot optimization

   Reduces the startup time by preventing the system from waiting for a internet connection.

   <Steps>

   1. #### Open Netplan config

      <Code lang="sh" code={`sudo nano /etc/netplan/50-cloud-init.yaml`} />

   2. #### Update config

      Add `optional: true` to your ethernet interface.

      <Code lang="yaml" title="/etc/netplan/50-cloud-init.yaml" code={netplanConfig} />

   3. #### Apply the config

      <Code lang="sh" code={`sudo netplan apply`} />

   </Steps>

</Steps>

---

## Wake-on-LAN (WOL)

If your computer supports Wake-on-LAN, you can send a “magic packet” to wake it from a powered-down state. This is primarily supported on Ethernet connections.

<Steps>

1. ### Identify network interface

   Find the name of your Ethernet adapter. Look for names starting with `e` (e.g., `eth0` or `enp3s0`).

   <Code lang="sh" code={`ip link show`} />

2. ### Install ethtool

   Install the utility required to manage network hardware settings.

   <Code lang="sh" code={`sudo apt update && sudo apt install ethtool -y`} />

3. ### Check support

   Verify if your hardware supports the magic packet. Look for `g` in the “Supports Wake-on” line.

   <Code lang="sh" code={`sudo ethtool $INTERFACE_NAME`} />

4. ### Enable WOL (temporary)

   Enable WOL manually to test the configuration. This setting will reset after a reboot.

   <Code lang="sh" code={`sudo ethtool -s $INTERFACE_NAME wol g`} />

5. ### Persist with systemd

   Create a service to ensure WOL is re-enabled automatically on every boot.

   <Code lang="sh" title="/etc/systemd/system/wol.service" code={wolService} />

6. ### Enable the service

   Reload systemd and enable the new service.

   <Code lang="sh" code={`sudo systemctl daemon-reload && sudo systemctl enable wol.service`} />

7. ### Send Wake-up packet

   From another device on the network, trigger the boot sequence using the target’s MAC address.

   <Code lang="sh" code={`wakeonlan $MAC_ADDRESS`} />

</Steps>

---
import Default from "@astrojs/starlight/components/ContentPanel.astro";
import type { Props } from "@astrojs/starlight/props";
---

<script>
  import { defaultSettingsLocalStorage, LS_SETTINGS_KEY } from "@/lib/constants";
  import { getStoredValues } from "@/lib/getStoredValues";
  import type { SettingsForm } from "@/types";

  document.addEventListener("DOMContentLoaded", () => {
    const settings = getStoredValues(LS_SETTINGS_KEY, defaultSettingsLocalStorage) as SettingsForm;

    const markdownContent = document.querySelector("main .sl-markdown-content") as HTMLDivElement;
    const updatedContent = markdownContent.innerHTML
      .replace(/{{{USERNAME_VAR}}}/g, settings.username)
      .replace(/{{{IP_ADDRESS_VAR}}}/g, settings.ipAddress)
      .replace(/{{{EXTERNAL_HDD_UUID_VAR}}}/g, settings.externalHddUuid)
      .replace(/{{{DOCKER_PATH_VAR}}}/g, settings.dockerPath)
      .replace(/{{{EXTERNAL_HDD_PATH_VAR}}}/g, settings.externalHddPath);

    markdownContent.innerHTML = updatedContent;
  });
</script>

<Default {...Astro.props}>
  <slot />
</Default>
